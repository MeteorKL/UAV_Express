<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>UAV Express</title>
  <script type="text/javascript" src="http://api.map.baidu.com/getscript?v=2.0&ak=maXe8MjLdvhu2lmFNYFs0Ou1ra3SfB85&services=&t=20170705114645"></script>
  <script type="text/javascript" src="http://api.map.baidu.com/library/LuShu/1.2/src/LuShu_min.js"></script>
  <script type="text/javascript" src="/js/uav.js"></script>
  <script type="text/javascript" src="/js/ajax.js"></script>
  <link rel="stylesheet" href="/css/paymentlist.css" />
</head>

<body>
  <div class="map">
    <div id="container"></div>
  </div>
  <div id="paymentlist" class="paymentlist">
    <ul>
      <li>
          <table class="top">
            <tr>
              <td><img src="https://fuss10.elemecdn.com/4/81/c83b0b530be44c7c8f671d0342613jpeg.jpeg?imageMogr2/thumbnail/200x200/format/webp/quality/85" /></td>
              <td><div><span>订单编号: </span><span>124324</span></div>
              <div><span>下单时间: </span><span>2017-07-15 18:31</span></div></td>
            </tr>
          </table>
          <ul class="foodlist">
            <li><span>散装国产红布林,450g</span><span>x1</span><span>¥10.5</span></li>
          </ul>
          <div><span>实付: </span><span>¥10.5</span></div>
      </li>
    </ul>
  </div>
  <script type="text/javascript">
    const UAV_STATUS_READY = 0
    const UAV_STATUS_SENDING = 1
    const UAV_STATUS_LANDING = 2
    const UAV_STATUS_RETURNING = 3
    initMap("container")
    var url = window.location.pathname.split('/')
    var user_id = url[2]
    url = '/user/' + user_id + '/payments'
    setInterval(() => {
      AjaxGet(url, (r) => {
        console.log(r)
        var id = 0
        var paymentlist = ''
        for (var i = 0; i < r.paymentlist.length; i++) {
          var payment = r.paymentlist[i];
          // paymentlist += `<ul><li><div><span>`
        }
        if (r.uav != null) {
          if (r.uav.status == UAV_STATUS_READY) {
            removeUav(id)
            uavs[id] = null
          } else {
            updateUav(id, r.uav.longitude, r.uav.latitude,
              r.uav.from_longitude, r.uav.from_latitude,
              r.uav.to_longitude, r.uav.to_latitude)
            uavs[id] = {
              id: id, longitude: r.uav.longitude, latitude: r.uav.latitude,
              from_longitude: r.uav.from_longitude, from_latitude: r.uav.from_latitude,
              to_longitude: r.uav.to_longitude, to_latitude: r.uav.to_latitude
            }
          }
        }
      }, (e) => {
        console.error(e)
      })
    }, 1000)
  </script>
</body>

</html>